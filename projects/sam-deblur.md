---
layout: project_page
permalink: /projects/sam-deblur

title: "SAM-Deblur: Let Segment Anything Boost Image Deblurring"
authors:
    "<a href='https://hplqaq.github.io/'>Siwei Li</a><sup>12</sup>, 
    <a href='https://arktis2022.github.io/'>Mingxuan Liu</a><sup>3</sup>, 
    <a href='https://hplqaq.github.io/projects/sam-deblur'>Yating Zhang</a><sup>1</sup>, 
    <a href='https://hplqaq.github.io/projects/sam-deblur'>Shu Chen</a><sup>1</sup>, 
    <a href='https://lihaoxiang-20.github.io/'>Haoxiang Li</a><sup>3</sup>, 
    <a href='https://hplqaq.github.io/projects/sam-deblur'>Zifei Dou</a><sup>1</sup>, 
    <a href='http://hongchen.ime.tsinghua.edu.cn/'>Hong Chen</a><sup>4</sup>"
affiliations:
    "<sup>1</sup>Beijing Xiaomi Mobile Software Co., Ltd.<br>
    <sup>2</sup>Department of Electronic Engineering, Tsinghua University<br>
    <sup>3</sup>Department of Biomedical Engineering, Tsinghua University<br>
    <sup>4</sup>School of Integrated Circuits, Tsinghua University"
paper: https://arxiv.org/abs/2309.02270
code: https://github.com/HPLQAQ/SAM-Deblur
---

<div class="columns is-centered has-text-centered">
    <div class="column is-four-fifths">
        <h2>Abstract</h2>
        <div class="content has-text-justified">
Image deblurring is a critical task in the field of image restoration, aiming to eliminate blurring artifacts. However, the challenge of addressing non-uniform blurring leads to an ill-posed problem, which limits the generalization performance of existing deblurring models. To solve the problem, we propose a framework SAM-Deblur, integrating prior knowledge from the Segment Anything Model (SAM) into the deblurring task for the first time. In particular, SAM-Deblur is divided into three stages. First, we preprocess the blurred images, obtain segment masks via SAM, and propose a mask dropout method for training to enhance model robustness.  Then, to fully leverage the structural priors generated by SAM, we propose a Mask Average Pooling (MAP) unit specifically designed to average SAM-generated segmented areas, serving as a plug-and-play component which can be seamlessly integrated into existing deblurring networks. Finally, we feed the fused features generated by the MAP Unit into the deblurring model to obtain a sharp image. Experimental results on the RealBlurJ, ReloBlur, and REDS datasets reveal that incorporating our methods improves GoPro-trained NAFNet's PSNR by 0.05, 0.96, and 7.03, respectively.
        </div>
    </div>
</div>

---

## Background
<div style="width: 50%; margin: auto; text-align: center;">
    <img src="./sam-deblur.assets/teaser_sam_deblur.png" alt="Mode Collapse" style="width: 100%; height: auto;">
    <p>The "mode collapse" in NAFNet: NAFNet trained on the GoPro dataset may output anomalous pixel regions during testing on the REDS dataset (indicated by the red boxes). This problem can be effectively solved by proposed SAM-Deblur.</p>
</div>

## Citation
```
@inproceedings{Li2023SAMDeblur,
  author       = {Siwei Li and
                  Mingxuan Liu and 
                  Yating Zhang and 
                  Shu Chen and 
                  Haoxiang Li and 
                  Zifei Dou and 
                  Hong Chen},
  title        = {SAM-Deblur: Let Segment Anything Boost Image Deblurring},
  booktitle    = {ICASSP 2024 - 2024 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)},
  year         = {2024}
  organization = {IEEE}
}
```
